# Copyright (c) 20224 Stogl Robotics Consulting UG (haftungsbeschränkt)
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

#
# Source of this file are templates in
# [RosTeamWorkspace](https://github.com/StoglRobotics/ros_team_workspace) repository.
#
# Author: Dr. Denis
#

/mcr/controller_manager:
  ros__parameters:
    update_rate: 1000  # Hz

    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster

    left_arm_trajectory_controller:
      type: velocity_controllers/JointGroupVelocityController

    right_arm_trajectory_controller:
      type: velocity_controllers/JointGroupVelocityController

    mpc_controller:
      type: mmco_dual_controller/MMCODualController

    mecanum_controller:
      type: mcr_mecanumbot_controller/MecanumbotDriveController

    right_arm_velocity_interface_controller:
      type: moying_mcr_arm_controller/VelcittInterfaceController

    left_arm_velocity_interface_controller:
      type: moying_mcr_arm_controller/VelcittInterfaceController

    left_gripper_robotiq_activation_controller:
      type: moying_mcr_gripper_controller/RobotiqActivationController

    right_gripper_robotiq_activation_controller:
      type: moying_mcr_gripper_controller/RobotiqActivationController
    

/mcr/joint_state_broadcaster:
  ros__parameters:
    update_rate: 100 #Hz
    
/mcr/mpc_controller:
  ros__parameters:
    update_rate: 100 #Hz
    joints:
      - left_arm_elfin_joint1
      - left_arm_elfin_joint2
      - left_arm_elfin_joint3
      - left_arm_elfin_joint4
      - left_arm_elfin_joint5
      - left_arm_elfin_joint6
      - right_arm_elfin_joint1
      - right_arm_elfin_joint2
      - right_arm_elfin_joint3
      - right_arm_elfin_joint4
      - right_arm_elfin_joint5
      - right_arm_elfin_joint6
    interface_name: velocity
    robot_name: mcr
    use_gui_target: false
    task_package_name: "moying_mcr_bringup"
    task_file: "/config/task.info"
    urdf_package_name: "moying_mcr_description"
    urdf_file: "/urdf/moying_mcr.urdf"
    lib_package_name: "moying_mcr_bringup"
    lib_folder: "/auto_generated"
    use_chain_interface: true
    chain_velocity_interface_name: velocity_interface_controller


/mcr/mecanum_controller:
  ros__parameters:
    update_rate: 100 #Hz
    fl_wheel_joint_name: forward_left_wheel_joint
    fr_wheel_joint_name: forward_right_wheel_joint
    rl_wheel_joint_name: back_left_wheel_joint
    rr_wheel_joint_name: back_right_wheel_joint
    wheel_radius: 0.1
    wheel_distance:
      width: 0.3
      length: 0.5
    linear_scale: 7.0
    radial_scale: 7.0
    max_linear: 0.2
    max_radial: 0.3
    direction: 1.0
  
/mcr/left_arm_velocity_interface_controller:
  ros__parameters:
    update_rate: 1000 #Hz
    joints:
      - left_arm_elfin_joint1
      - left_arm_elfin_joint2
      - left_arm_elfin_joint3
      - left_arm_elfin_joint4
      - left_arm_elfin_joint5
      - left_arm_elfin_joint6
    ft_joint: "left_arm_robotiq_ft_sensor"
    interface_name: velocity
    use_dynamics_models: true 
    use_pid: false
    device_name: elfin3
    coulomb_scale: [0.1,0.3,0.3,0.75,0.75,0.50]
    ft_offset: [-43.878816,17.973876,72.760725,2.781771,1.204735,-1.667312]
    gripper_mass: 1.3
    end_link_name: "left_arm_elfin_end_link"
    urdf_package: "moying_mcr_description"
    urdf_path: "/urdf/left_only.urdf"
    effort_limit: [104.0, 104.0, 69.0, 69.0, 34.0, 34.0]
    imp_limit: 0.05
    kp_cart: [30.0, 30.0, 500.0, 5000.0, 5000.0, 5000.0]  
    elfin1:
      kp: 44.820
      kd: 0.2
      ki: 0.0
      ki_max: 10.0
    elfin2:
      kp: 44.820
      kd: 0.05
      ki: 0.0
      ki_max: 10.0
    elfin3:
      kp: 28.830
      kd: 0.0
      ki: 0.0
      ki_max: 8.0
    elfin4:
      kp: 20.0
      kd: 0.05
      ki: 0.0
      ki_max: 5.0
    elfin5:
      kp: 20.0
      kd: 0.0
      ki: 0.0
      ki_max: 5.0
    elfin6:
      kp: 20.0
      kd: 0.0
      ki: 0.0
      ki_max: 3.0

/mcr/right_arm_velocity_interface_controller:
  ros__parameters:
    update_rate: 1000 #Hz
    joints:
      - right_arm_elfin_joint1
      - right_arm_elfin_joint2
      - right_arm_elfin_joint3
      - right_arm_elfin_joint4
      - right_arm_elfin_joint5
      - right_arm_elfin_joint6
    ft_joint: "right_arm_robotiq_ft_sensor"
    interface_name: velocity
    use_dynamics_models: true 
    use_pid: false
    device_name: elfin3
    coulomb_scale: [0.1,0.3,0.3,0.75,0.65,0.50]
    ft_offset: [47.723,33.651,56.73,0.48306,-3.811733,-0.4609045]
    gripper_mass: 1.3
    end_link_name: "right_arm_elfin_end_link"
    urdf_package: "moying_mcr_description"
    urdf_path: "/urdf/right_only.urdf"
    effort_limit: [104.0, 104.0, 69.0, 69.0, 34.0, 34.0]
    imp_limit: 0.05
    kp_cart: [10.0, 10.0, 500.0, 5000.0, 5000.0, 5000.0]  
    elfin1:
      kp: 44.820
      kd: 0.0
      ki: 8.0
      ki_max: 10.0
    elfin2:
      kp: 44.820
      kd: 0.05
      ki: 4.0
      ki_max: 10.0
    elfin3:
      kp: 28.830
      kd: 0.0
      ki: 2.50
      ki_max: 8.0
    elfin4:
      kp: 20.0
      kd: 0.05
      ki: 2.0
      ki_max: 5.0
    elfin5:
      kp: 20.0
      kd: 0.0
      ki: 2.0
      ki_max: 5.0
    elfin6:
      kp: 20.0
      kd: 0.0
      ki: 1.0
      ki_max: 3.0
  
/mcr/left_arm_trajectory_controller:
  ros__parameters:
    joints:
      - left_arm_velocity_interface_controller/left_arm_elfin_joint1
      - left_arm_velocity_interface_controller/left_arm_elfin_joint2
      - left_arm_velocity_interface_controller/left_arm_elfin_joint3
      - left_arm_velocity_interface_controller/left_arm_elfin_joint4
      - left_arm_velocity_interface_controller/left_arm_elfin_joint5
      - left_arm_velocity_interface_controller/left_arm_elfin_joint6

/mcr/right_arm_trajectory_controller:
  ros__parameters:
    joints:
      - right_arm_velocity_interface_controller/right_arm_elfin_joint1
      - right_arm_velocity_interface_controller/right_arm_elfin_joint2
      - right_arm_velocity_interface_controller/right_arm_elfin_joint3
      - right_arm_velocity_interface_controller/right_arm_elfin_joint4
      - right_arm_velocity_interface_controller/right_arm_elfin_joint5
      - right_arm_velocity_interface_controller/right_arm_elfin_joint6

/mcr/left_gripper_robotiq_activation_controller:
  ros__parameters:
    update_rate: 10 #Hz
    # joy_topic_name: /mcr/robotiq_controller/joy
    joy_topic_name: /mcr/joy
    joint_name: left_arm_robotiq_85_left_knuckle_joint
    control_key: 7   #我的手柄RB是7,宁哥的手柄估计是5

/mcr/right_gripper_robotiq_activation_controller:
  ros__parameters:
    update_rate: 10 #Hz
    # joy_topic_name: /mcr/robotiq_controller/joy
    joy_topic_name: /mcr/joy
    joint_name: right_arm_robotiq_85_left_knuckle_joint
    control_key: 7   #我的手柄RB是7,宁哥的手柄估计是5

